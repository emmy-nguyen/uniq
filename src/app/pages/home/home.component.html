<!-- Mobile/Tablet header with menu toggle -->
<div
  *ngIf="showDrawerToggle"
  class="fixed top-16 left-0 right-0 z-[9999] bg-transparent px-4 py-3 flex items-center gap-3"
>
  <button
    mat-icon-button
    (click)="toggleDrawer()"
    class="text-gray-600"
    aria-label="Toggle filters menu"
  >
    <mat-icon>{{ drawerOpened ? "close" : "filter_list" }}</mat-icon>
  </button>
</div>

<mat-drawer-container
  [autosize]="true"
  class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100"
  (backdropClick)="onBackdropClick()"
>
  <mat-drawer
    [mode]="drawerMode"
    [opened]="drawerOpened"
    [class]="getDrawerClasses()"
    [disableClose]="drawerMode === 'side'"
    class="h-screen overflow-hidden"
    (openedChange)="onDrawerStateChange($event)"
  >
    <div class="h-full flex flex-col">
      <div
        *ngIf="showDrawerToggle"
        class="flex-shrink-0 justify-between items-center p-4 bg-gradient-to-br from-gray-50 to-gray-100 h-[80px]"
      ></div>

      <div *ngIf="!isMobile" class="p-6 flex-shrink-0 border-b border-gray-200">
        <blockquote class="text-gray-700 italic text-lg leading-relaxed">
          "Every artist dips his brush in his own soul, and paints his own
          nature into his pictures."
        </blockquote>

        <cite class="block mt-3 text-yellow-700 font-semibold"
          >â€” Henry Ward Beecher</cite
        >
      </div>

      <div class="p-6 overflow-y-auto" [class.p-4]="isMobile">
        <app-filters
          (showCategory)="onShowCategory($event)"
          class="space-y-4"
          [isMobile]="isMobile"
        ></app-filters>
      </div>
    </div>
  </mat-drawer>

  <!-- Main Content -->
  <mat-drawer-content
    [class]="getContentClass()"
    [style.margin-top]="showDrawerToggle ? '30px' : '0'"
  >
    <div class="max-w-7xl mx-auto">
      <!-- Sort part -->
      <div
        class="z-10 bg-[#f6f6f6]/95 backdrop-blur-md rounded-lg mb-4"
        [style.top]="showDrawerToggle ? '64px' : '0'"
      >
        <div class="px-4 py-4" [class.px-6]="!isMobile">
          <app-products-header
            (columnsCountChange)="onColumnsCountChange($event)"
            (itemsCountChange)="onItemsCountChange($event)"
            (sortChange)="onSortChange($event)"
            [isMobile]="isMobile"
            [isTablet]="isTablet"
            [isDesktop]="isDesktop"
            [currentCols]="cols"
            [currentSort]="sort"
            [currentItemsCount]="count"
          >
          </app-products-header>
        </div>
      </div>

      <!-- Content Area -->
      <div [class]="getContainerClasses()">
        <!-- Loading Skeleton -->
        <div *ngIf="isLoading" [class]="getSkeletonGridClasses()">
          <div
            *ngFor="let skeleton of [1, 2, 3, 4, 5, 6, 7, 8]"
            class="bg-white shadow-sm border border-gray-100 p-4 animate-pulse rounded-lg"
          >
            <div
              class="bg-gray-200 mb-4 rounded"
              [class.h-48]="!isMobile"
              [class.h-40]="isMobile"
            ></div>
            <div class="space-y-2">
              <div class="bg-gray-200 h-4 w-3/4 rounded"></div>
              <div class="bg-gray-200 h-4 w-1/2 rounded"></div>
            </div>
          </div>
        </div>

        <!-- Title Section -->
        <div class="flex flex-col items-center mb-6">
          <h1
            class="font-semibold text-center"
            [class.text-2xl]="!isMobile"
            [class.text-xl]="isMobile"
          >
            Our <span class="text-[#e04639]">Paintings</span>
          </h1>
          <p
            class="font-semibold text-gray-600 uppercase text-center"
            [class.text-sm]="!isMobile"
            [class.text-xs]="isMobile"
          >
            Our Products
          </p>
        </div>

        <!-- Products Grid -->
        <mat-grid-list
          *ngIf="!isLoading"
          [gutterSize]="isMobile ? '8' : '16'"
          [cols]="cols"
          [rowHeight]="getRowHeight()"
          class="overflow-hidden"
        >
          <mat-grid-tile
            *ngFor="let product of products"
            class="transition-all duration-300"
            [class.hover:scale-[1.02]]="!isMobile"
          >
            <div
              class="w-full h-full"
              [class.p-1]="!isMobile"
              [class.p-0.5]="isMobile"
            >
              <app-product-box
                [product]="product"
                (addToCart)="onAddToCart($event)"
                class="w-full h-full block"
                [fullWidthMode]="cols === 1"
                [isMobile]="isMobile"
                [class]="getProductBoxClasses()"
              >
              </app-product-box>
            </div>
          </mat-grid-tile>
        </mat-grid-list>
      </div>
    </div>
  </mat-drawer-content>
</mat-drawer-container>
